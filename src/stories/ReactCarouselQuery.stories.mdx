import { Meta, Story, Canvas } from '@storybook/addon-docs/blocks';
import ReactCarouselQuery from '../'

<Meta title="Examples/InfiniteCarousel" component={ReactCarouselQuery} />

# Infinite Carousel

<Canvas>
  <Story name="Basic">
    {(args) => {
      const getUrl = (offset, limit) => {
        const BASE_URL = 'https://gateway.marvel.com/v1/public/characters?'
        const apikey = `apikey=6f8dd93444b9ab8e3be7f6812d373b00`
        const params = `&offset=${offset}&limit=${limit}`
        return `${BASE_URL}${apikey}${params}`
      }
      const formatData = response => {
        const { offset, total, results } = response
        return {
          offset,
          total,
          items: results,
        }
      }
      const getData = async ({ offset, limit }) => {
        const url = getUrl(offset, limit)
        const { data } = await (await fetch(url)).json()
        return formatData(data)
      }
      const renderItem = ({ item }) => {
        const imgSrc = `${item.thumbnail.path}.${item.thumbnail.extension}`
        return (
          <div style={{ height: '100%' }}>
            <img
              draggable={false}
              alt={item.name}
              style={{
                display: 'block',
                objectFit: 'cover',
                height: '80%',
                width: '100%',
                background: '#ffffff url("/assets/iconLoading.svg") no-repeat center',
              }}
              src={imgSrc}
            />
            <div style={{ height: '20%', backgroundColor: 'white', color: '#151515' }}>
              <h3>{item.name}</h3>
              <p className="line-clamp">{item.description || 'Description not available'}</p>
            </div>
          </div>
        )
      }
      return <ReactCarouselQuery renderItem={renderItem} getData={getData} />
    }}
   </Story>
</Canvas>

### What is?
ReactCarouselQuery is a Infinite Carousel Component made with React. It handles the pagination requests for you and is dependencies free.

### How to import

```jsx
import ReactCarouselQuery from "react-carousel-query";
```

### How to use

```jsx
<ReactCarouselQuery renderItem={renderItem} getData={getData} />
```


### Props

#### renderItem
Render each slide as you wish!

```jsx
const renderItem = ({ name, description, imgSrc }) => (
  <div style={{ height: '100%' }}>
    <img
      src={imgSrc}
      draggable={false}
      alt={name}
      style={{
        display: 'block',
        objectFit: 'cover',
        height: '80%',
        width: '100%',
        background: '#ffffff url("/assets/iconLoading.svg") no-repeat center',
      }}
    />
    <div style={{ height: '20%', backgroundColor: 'white', color: '#151515' }}>
      <h3>{name}</h3>
        <p className="line-clamp">{description || 'Description not available'}</p>
    </div>
  </div>
)
```

#### getData
This should be an async function that returns the items info like the pictures sources to be fetched.
Should respect the following format: `{ offset: number; total: number; items: { id, imgSrc }[] }`

```jsx
const getData = async ({ currentOffset, limit }) => {
  const { data: { offset, total, items } } = await (await fetch('http://someApi.com')).json()
  return { offset, total, items }
}
```

